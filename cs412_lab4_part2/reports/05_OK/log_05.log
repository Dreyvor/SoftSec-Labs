INFO: Seed: 3452853347
INFO: Loaded 1 modules   (243 inline 8-bit counters): 243 [0x797470, 0x797563), 
INFO: Loaded 1 PC tables (243 PCs): 243 [0x572cb8,0x573be8), 
INFO:        2 files found in ../seeds
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
INFO: seed corpus: files: 2 min: 287b max: 1070b total: 1357b rss: 37Mb

=================================================================
==18122==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 40100 byte(s) in 1 object(s) allocated from:
    #0 0x5122b0 in __interceptor_malloc (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x5122b0)
    #1 0x55488d in store_idat_rgb_alpha /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:914:35
    #2 0x5560d4 in store_png_rgb_alpha /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:996:5
    #3 0x556de4 in store_png /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:1058:9
    #4 0x54aa6f in LLVMFuzzerTestOneInput /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba.c:26:5
    #5 0x42ebc7 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x42ebc7)
    #6 0x4372c0 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4372c0)
    #7 0x4388c6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4388c6)
    #8 0x43a972 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x43a972)
    #9 0x429e5c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x429e5c)
    #10 0x41cd22 in main (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x41cd22)
    #11 0x7f09a9823b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

Direct leak of 40000 byte(s) in 1 object(s) allocated from:
    #0 0x5122b0 in __interceptor_malloc (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x5122b0)
    #1 0x54ee52 in convert_rgb_alpha_to_image /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:464:19
    #2 0x54fb2d in convert_data_to_image /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:517:20
    #3 0x54fc00 in parse_png_no_interlace /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:528:12
    #4 0x54fe22 in parse_png /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:542:20
    #5 0x550cab in load_png /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:693:12
    #6 0x54a9f8 in LLVMFuzzerTestOneInput /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba.c:25:7
    #7 0x42ebc7 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x42ebc7)
    #8 0x4372c0 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4372c0)
    #9 0x4388c6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4388c6)
    #10 0x43a972 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x43a972)
    #11 0x429e5c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x429e5c)
    #12 0x41cd22 in main (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x41cd22)
    #13 0x7f09a9823b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

Direct leak of 1013 byte(s) in 1 object(s) allocated from:
    #0 0x512730 in realloc (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x512730)
    #1 0x553e44 in compress_png_data /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:876:28
    #2 0x555063 in store_idat_rgb_alpha /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:932:5
    #3 0x5560d4 in store_png_rgb_alpha /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:996:5
    #4 0x556de4 in store_png /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:1058:9
    #5 0x54aa6f in LLVMFuzzerTestOneInput /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba.c:26:5
    #6 0x42ebc7 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x42ebc7)
    #7 0x4372c0 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4372c0)
    #8 0x4388c6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4388c6)
    #9 0x43a972 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x43a972)
    #10 0x429e5c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x429e5c)
    #11 0x41cd22 in main (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x41cd22)
    #12 0x7f09a9823b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

Direct leak of 20 byte(s) in 1 object(s) allocated from:
    #0 0x5122b0 in __interceptor_malloc (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x5122b0)
    #1 0x550b67 in load_png /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/pngparser.c:592:66
    #2 0x54a9f8 in LLVMFuzzerTestOneInput /media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba.c:25:7
    #3 0x42ebc7 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x42ebc7)
    #4 0x4372c0 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4372c0)
    #5 0x4388c6 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x4388c6)
    #6 0x43a972 in fuzzer::Fuzzer::Loop(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, fuzzer::fuzzer_allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x43a972)
    #7 0x429e5c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x429e5c)
    #8 0x41cd22 in main (/media/brad/HDD_1TB_intern/EPFL/SYSCOM/MA01/SoftSec/Labs/SoftSec-Labs/cs412_lab4_part2/src/fuzzer_store_png_rgba+0x41cd22)
    #9 0x7f09a9823b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: 81133 byte(s) leaked in 4 allocation(s).

INFO: a leak has been found in the initial corpus.

INFO: to ignore leaks on libFuzzer side use -detect_leaks=0.

MS: 0 ; base unit: 0000000000000000000000000000000000000000
artifact_prefix='./'; Test unit written to ./leak-41d80f4911ffb240439c1aa7d4cb4f97f2a68ad7
